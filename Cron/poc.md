# Cron 데몬과 Crontab 스케줄 관리

## 개요

- 본 문서는 Linux 환경에서 주기적인 작업을 자동으로 실행하기 위한  
  Cron 데몬과 crontab 스케줄 관리 방법을 정리한 학습 문서입니다.
- crond 데몬의 역할과 관련 파일을 확인하고  
  crontab 명령을 이용한 스케줄 등록 과정을 실습을 통해 확인합니다.
- 또한 스케줄 실행 로그를 확인하여  
  작업이 정상적으로 수행되었는지 검증합니다.

---

## Cron 데몬 개요

- Cron은 주기적으로 작업되는 작업 일정을 저장하여  
  자동으로 실행하는 데몬입니다.
- at, anacron과 같이 다양한 스케줄링 프로그램이 지원됩니다.
- 일반적으로 시스템 부팅 시 crond 데몬이 실행됩니다.

---

## Cron 관련 파일

- 주요 Cron 관련 파일은 다음과 같습니다.
```text
경로 : /usr/lib/systemd/system/crond.service  
역할 : 데몬 실행 스크립트  
설명 : systemctl 명령어로 제어됩니다.
```
```text
경로 : /etc/rc.d/init.d/crond  
역할 : 데몬 실행 스크립트  
설명 : service 명령어 기반입니다.
```
```text
경로 : /etc/crontab  
역할 : 기본 스케줄 일정 파일  
설명 : 시스템 전역 스케줄이 정의됩니다.
```
```text
경로 : /usr/bin/crontab  
역할 : 스케줄 설정 프로그램 파일  
```
```text
경로 : /etc/cron.allow, /etc/cron.deny  
역할 : crontab 명령 사용 제한  
설명 : 등록된 계정에 대해 허용 또는 거부합니다.
```
---

## Crontab 명령어 개요

- crontab 명령어를 이용하여 스케줄을 정의합니다.
- 사용자별로 독립적인 스케줄을 관리할 수 있습니다.

`사용 형식 `
```text
crontab -u 사용자 옵션
```
---

## Crontab 옵션

- 주요 옵션은 다음과 같습니다.
```text
e : 스케줄 등록  
설명 : vi 편집기로 스케줄을 등록합니다.

l : 스케줄 확인  
설명 : 현재 등록된 스케줄을 출력합니다.

r : 스케줄 초기화  
설명 : 등록된 모든 스케줄을 삭제합니다.
```
---

## Crontab 시간 형식

- 스케줄은 다음 형식으로 정의됩니다.

`분` `시` `일` `월` `요일` `작업내용`

- 시간 범위는 다음과 같습니다.
```text
분 : 0 ~ 59  
시 : 0 ~ 23  
일 : 1 ~ 31  
월 : 1 ~ 12  
요일 : 0(일요일) ~ 6(토요일)
```
---

## Crontab 예제

- 매시간마다 시간 동기화 실행
```text
00 0-23 * * * rdate -s time.bora.net
```
- 10분마다 소유자 변경
```text
0-59/10 * * * * chown -R data.st /home/data
```
- 10분마다 권한 변경
```text
0-59/10 * * * * chmod -R 775 /home/data
```
---

## 기간 지정 형식

- 기간 지정 방식은 다음과 같습니다.
```text
#-# : 실행 범위 지정  
#-#/# : 범위 내 실행 간격 지정  
```
`예시`
```text
00 9-18/2 1-15/3 1-12/4 1-5 backup.sh
```
---

## Crontab 실습

- 다음 명령어로 crontab 편집 모드로 진입합니다.
```text
crontab -e
```
![01](/Cron/imgs/01.png)

- vi 편집기로 진입됩니다.
- 필자는 예시로 `/home/data` 디렉토리의 권한을  
  매분마다 `777`로 변경하도록 설정했습니다.
```text
* * * * * chmod -R 777 /home/data
```
![02](/Cron/imgs/02.png)

---

## 시스템 기본 Crontab 확인

- 시스템 전역 스케줄 파일을 확인합니다.
```text
cat /etc/crontab
```
![03](/Cron/imgs/03.png)

- 시스템 레벨에서 동작하는 스케줄을 확인할 수 있습니다.

---

## Cron 실행 로그 확인

- Cron 작업 실행 로그는 다음 파일에서 확인할 수 있습니다.
```text
cat /var/log/cron
```
![04](/Cron/imgs/04.png)

- 언제 어떤 명령어가 실행되었는지 기록됩니다.
- 스케줄 정상 동작 여부를 확인할 수 있습니다.

---

## 정리

- Cron은 주기적인 작업을 자동으로 실행하는 데몬입니다.
- crontab 명령어를 통해 사용자별 스케줄을 관리할 수 있습니다.
- 시간 필드를 조합하여 다양한 주기 설정이 가능합니다.
- 실행 결과는 `/var/log/cron` 파일을 통해 확인할 수 있습니다.
- 서버 운영 및 자동화 작업에 필수적인 기능입니다.
