# Permission

- **리눅스는 멀티유저 시스템이므로, 파일 및 디렉토리에 대한 접근을 권한(Permission)을 통해 제어합니다.**  
- 파일 및 디렉토리의 권한을 보기 위해 `ls -l` 명령어를 사용하면 다음 사진과 같이 각 파일 및 디렉토리의 사용자, 그룹, 다른 이들의 파일 권한을 확인할 수 있습니다.

![01](/Permission/imgs/01.png)

---

## 파일 권한 기본 구조 (10자리)

- 파일 권한은 총 **10자리**로 구성되며, 크게 **4개 파트**로 나뉩니다.
```text
Ex) -rwx---rwx
```
| 위치 | 구분 | 상세 내용 |
|:---:|:---:|:---|
| **1** | **파일 타입** | `-`: 일반 파일<br>`d`: 디렉토리<br>`l`: 심볼릭 링크<br>`c`: 문자 디바이스 (키보드, 콘솔 등 데이터를 한 글자씩 주고받음)<br>`b`: 블록 디바이스 (하드디스크 등 데이터를 덩어리/블록 단위로 주고받음) |
| **2~4** | **소유자 (User)** | 파일을 만든 사용자(Owner)의 권한 (rwx) |
| **5~7** | **그룹 (Group)** | 파일이 속한 그룹(Group) 멤버들의 권한 (rwx) |
| **8~10** | **기타 (Others)** | 그 외 나머지 모든 제3자의 권한 (rwx) |

---

## 권한 기호 및 값

- 각 자리에 들어가는 기호는 다음과 같은 의미와 8진수 값을 가집니다.

| 기호 | 의미 | 설명 | 숫자 값 |
|:---:|:---:|:---|:---:|
| **r** | Read | 읽기 권한 | 4 |
| **w** | Write | 쓰기/수정 권한 | 2 |
| **x** | Execute | 실행 권한 | 1 |
| **-** | None | 권한 없음 | 0 |

- 리눅스에서는 같은 `rwx` 기호라도 대상이 **파일(File)**인지 **디렉토리(Directory)**인지에 따라 실제 의미가 다릅니다.

| 구분 | 파일 (File) | 디렉토리 (Directory) |
|:---:|:---|:---|
| **r** | 파일의 내용을 볼 수 있음 | 디렉토리 내 파일 리스트 확인 가능 |
| **w** | 파일의 내용을 수정할 수 있음 | 디렉토리 내 파일 생성 및 삭제 가능 |
| **x** | 파일을 프로그램으로 실행 가능 | `cd` 명령어로 해당 디렉토리 진입 가능 |

---

## 파일 권한 확인 예제

- 확장자 cfg로 끝나는 모든 파일의 디렉토리 상세 정보를 리스트 형태로 출력합니다.
```text
ls -l *.cfg
```
![02](/Permission/imgs/02.png)

- 결과로 `anaconda-ks.cfg`와 `initial-setup-ks.cfg` 두 개의 파일 정보가 출력됩니다.

---

## 디렉토리 파일만 필터링

- 파일 타입이 디렉토리인 항목만 찾기 위해 다음 명령어를 실행합니다.
```text
ls -al | grep ^d
```
- `ls -al` 결과 중 첫 글자가 d로 시작하는 행만 필터링하여 출력합니다.

![03](/Permission/imgs/03.png)

---

## 문자 디바이스 파일 (Character Device)

![04](/Permission/imgs/04.png)

- `ls -l` 출력에서 파일 타입이 **c**로 시작하는 파일은 문자 디바이스 파일입니다.

### 개념 정의
- 데이터를 한 글자(Byte)씩 순차적으로 주고받는 장치 파일입니다.
- 데이터를 한꺼번에 모아서 처리하지 않고 실시간으로 전송합니다.

### 왜 사용하는가
- 키보드, 마우스, 시리얼 포트 같은 장치와 운영체제가 소통하기 위해 사용됩니다.
- 사용자가 입력한 문자를 즉시 전달해야 하기 때문입니다.

### 대표적인 예시
- `/dev/tty`
- `/dev/vcs`
- `/dev/mouse`

---

## 심볼릭 링크

![05](/Permission/imgs/05.png)

- 파일 타입이 **l**로 표시되며 심볼릭 링크를 의미합니다.

### 개념 정의
- 실제 데이터를 저장하지 않고 **원본 파일이나 디렉토리의 경로 정보를 담고 있는 특수 파일**입니다.
- 윈도우의 바로가기 아이콘과 동일한 개념입니다.

### 왜 사용하는가
- 접근 편의성 향상
- 시스템 라이브러리 버전 및 호환성 관리

### 주요 특징
- 원본 파일이 이동하거나 삭제되면 링크가 끊어짐 (Broken Link)
- `ls -l` 출력 시 `파일명 -> 원본경로` 형태로 표시
- 파일과 디렉토리 모두 링크 가능

### 대표적인 예시
- `/bin/sh`
- `/etc/localtime`

---

## 권한 변경 실습 환경

- `a.txt`, `b.txt`, `c.txt` 세 파일을 `txtflle` 디렉토리에 넣어 권한 변경 실습을 진행합니다.

![06](/Permission/imgs/06.png)

---

## 숫자 권한 표기법

- 원하는 권한 조합의 숫자를 모두 더하면 해당 사용자의 권한 숫자가 됩니다.

- **7** (4+2+1): rwx
- **6** (4+2+0): rw-
- **5** (4+0+1): r-x
- **4** (4+0+0): r--

- `chmod` 명령어에서 사용하는 세 자리 숫자는 다음을 의미합니다.

| 위치 | 대상 | 의미 |
|:---:|:---:|:---|
| **첫 번째 숫자** | 소유자 (User) | 파일을 소유한 사용자의 권한 |
| **두 번째 숫자** | 그룹 (Group) | 파일이 속한 그룹의 권한 |
| **세 번째 숫자** | 기타 (Others) | 그 외 나머지 사용자의 권한 |

| 숫자 | 권한 | 설명 |
|:---:|:---:|:---|
| **755** | rwxr-xr-x | 일반적인 프로그램/디렉토리 |
| **644** | rw-r--r-- | 일반적인 문서 파일 |
| **600** | rw------- | 비밀 키, 개인 설정 파일 |
| **700** | rwx------ | 개인 실행 파일/디렉토리 |

---

## chmod 숫자 방식 실습

- txtflle 내부에서 파일 권한을 확인한 후 다음 명령어를 실행합니다.
```text
chmod 750 a.txt
```
- 소유자: 읽기/쓰기/실행
- 그룹: 읽기/실행
- 기타 사용자: 접근 불가

![07](/Permission/imgs/07.png)

---

## 디렉토리 권한 변경

- 디렉토리의 권한을 변경할 때는 `-R` 옵션을 사용합니다.
```text
chmod -R 777 txtflle/
```
![08](/Permission/imgs/08.png)

---

## 기호 표기법 권한 설정

- 숫자 대신 문자(`u, g, o, a`)와 기호(`+, -, =`)를 사용하여 권한을 세밀하게 조정할 수 있습니다.

### 대상 지정 

| 기호 | 대상 | 설명 |
|:---:|:---:|:---|
| **u** | User | 파일 소유자 |
| **g** | Group | 파일 소유 그룹 |
| **o** | Others | 기타 사용자 |
| **a** | All | 모든 사용자 |

### 연산자

| 기호 | 의미 | 설명 |
|:---:|:---:|:---|
| **+** | 추가 | 기존 권한에 권한 추가 |
| **-** | 제거 | 기존 권한 제거 |
| **=** | 설정 | 권한 덮어쓰기 |

### 권한 종류

| 기호 | 의미 |
|:---:|:---|
| **r** | Read |
| **w** | Write |
| **x** | Execute |

---

## 기호 표기법 실습

- 모든 사용자 실행 권한 제거
```text
chmod a-x a.txt
```
![09](/Permission/imgs/09.png)

- 그룹과 기타 사용자 실행 권한 제거
```text
chmod g-x,o-x b.txt c.txt
```
![10](/Permission/imgs/10.png)

---

## 파일 소유자 및 그룹 변경

- 파일 소유자 변경
```text
chown ast11 a.txt
```
![11](/Permission/imgs/11.png)

- 파일 소유 그룹 변경
```text
chgrp st a.txt
```
![12](/Permission/imgs/12.png)

---

## chown 확장 사용법

| 형식 | 명령어 예시 | 설명 |
|:---|:---|:---|
| 소유자만 변경 | chown ast11 a.txt | 소유자 변경 |
| 그룹만 변경 | chown .root a.txt | 그룹 변경 |
| 동시 변경 | chown ast11.root a.txt | 소유자/그룹 변경 |

- 콜론(:) 사용도 동일하게 동작합니다.
```text
chown ast11:root a.txt
```
- 재귀적 변경
```text
chown -R ast11.root txtflle/
```
---

## 최종 소유권 변경 예제

- 소유자와 그룹을 root로 변경
```text
chown root.root a.txt
```
![13](/Permission/imgs/13.png)

- 그룹만 변경
```text
chown .st a.txt
```
![14](/Permission/imgs/14.png)
