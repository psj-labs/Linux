# 01. ip 명령어 & 네트워크 확인

## 개요

- 본 문서는 Linux 환경에서 ip 명령어의 구조와 사용법, 네트워크 인터페이스 및 라우팅 정보를 확인하는 방법을 정리합니다.
- 기존 ifconfig, route 명령어를 대체하는 `ip 명령어`를 중심으로 정리합니다.

---

## ip 명령어 기본 구조

- ip 명령어는 다음과 같은 구조를 가집니다.
```text
ip [옵션] object command arguments
```
- object : 하위 객체
  - link
  - address
  - route
  - neighbor
- command : 수행 작업
  - show
  - set
  - add
  - del

---

## object와 command 조합

### link (l)

- 인터페이스 링크 상태 관리

| 명령어 | 설명 |
|---|---|
| ip link show | 모든 인터페이스 링크 상태 확인 |
| ip link set ens160 up | ens160 인터페이스 활성화 |
| ip link set ens160 down | ens160 인터페이스 비활성화 |

---

### address (a)

- IP 주소 관리

| 명령어 | 설명 |
|---|---|
| ip address show | 모든 인터페이스 IP 정보 확인 |
| ip a show dev ens160 | 특정 NIC의 IP 설정 확인 |
| ip address add 1.2.3.4/24 dev ens160 | IP 주소 추가 |
| ip address del 1.2.3.4/24 dev ens160 | IP 주소 삭제 |

---

### route (r)

- 라우팅 테이블 관리

| 명령어 | 설명 |
|---|---|
| ip route show | 전체 라우팅 테이블 확인 |
| ip route show default | Default Gateway 확인 |
| ip route add 2.1.1.0/24 via 1.1.1.254 dev ens160 | 라우트 추가 |
| ip route del 2.1.1.0/24 | 라우트 삭제 |

---

### neighbor (n)

- ARP / NDP 테이블 관리

| 명령어 | 설명 |
|---|---|
| ip neighbor show | 이웃 테이블 확인 |
| ip neighbor add 1.2.3.4 lladdr 02:02:02:02:02:02 dev ens160 | ARP 항목 추가 |
| ip neighbor del 1.2.3.4 dev ens160 | ARP 항목 삭제 |

---

## ip 명령어 옵션 정리

| 옵션 | 설명 | 사용 예 |
|---|---|---|
| -s | 통계 정보 출력 | ip -s link show ens160 |
| -d | 상세 정보 출력 | ip -d address show |
| -4 | IPv4 정보만 출력 | ip -4 address show |
| -6 | IPv6 정보만 출력 | ip -6 address show |
| -c | 컬러 출력 | ip -c address show |
| -o | 한 줄로 출력 | ip -o route show |
| -br | 필수 정보만 간략히 출력 | ip -br route show |

---

## 네트워크 확인

### 인터페이스 및 기본 정보 확인

- ip address 명령어는 모든 인터페이스의 IP 설정과 상태를 확인할 수 있습니다.
- ip address show, ip add, ip a 등으로 축약 사용이 가능합니다.

| 명령어 | 설명 |
|---|---|
| ip address | 모든 인터페이스 IP 정보 확인 |
| ip a show dev ens160 | 특정 NIC 설정 정보 확인 |
| ip link show | 인터페이스 링크 상태 확인 |
| ip link show ens160 | 특정 인터페이스 링크 상태 확인 |

---

## Default Gateway 확인

- 라우팅 정보를 통해 기본 게이트웨이를 확인합니다.

| 명령어 | 설명 |
|---|---|
| ip route show default | Default Gateway 확인 |
| ip route | 전체 라우팅 테이블 확인 |

---

## Local DNS 확인

- 시스템에서 사용하는 DNS 서버 정보는 resolv.conf 파일을 통해 확인합니다.

| 명령어 | 설명 |
|---|---|
| cat /etc/resolv.conf | 로컬 DNS 설정 확인 |

---

## TCP/IP 네트워크 설정 파일 개요

### 네트워크 설정 파일

- NetworkManager가 활성화된 경우 설정 파일을 직접 편집하지 않습니다.

| 파일 경로 | 적용 환경 | 설명 |
|---|---|---|
| /etc/sysconfig/network-scripts/ifcfg-NIC | Rocky Linux 8 | 네트워크 인터페이스 설정 파일 |
| /etc/NetworkManager/system-connections/NIC.nmconnection | Rocky Linux 9 | NetworkManager 인터페이스 설정 파일 |
| /etc/resolv.conf | 공통 | DNS 서버 설정 파일 |
| /etc/hostname | 공통 | 호스트명 설정 파일 |

- 네트워크 설정 파일에는 IP 주소, 서브넷 마스크, 게이트웨이 정보가 포함됩니다.
- resolv.conf 파일에는 DNS 서버 정보가 설정됩니다.
- hostname 파일에는 시스템의 호스트명이 설정됩니다.

---

## 추가 네트워크 설정 파일

| 파일 경로 | 설명 |
|---|---|
| /etc/sysconfig/network | 호스트명, Gateway, NOZEROCONF 옵션 설정 |

- NOZEROCONF=yes 옵션은 Zero Configuration Networking에서 예약된  
  서브넷 사용을 제거합니다.
- 필수 옵션은 아니며, 환경에 따라 선택적으로 사용됩니다.

---

## TCP/IP 설정 파일 예시

### Rocky Linux 8

- `/etc/sysconfig/network-scripts/ifcfg-ens160`
- 주요 설정 항목
  - DEVICE
  - ONBOOT
  - IPADDR
  - PREFIX
  - GATEWAY
  - DNS

---

### Rocky Linux 9

- `/etc/NetworkManager/system-connections/ens160.nmconnection`
```text
UUID=6bd1eb14-354a-4e0b-95a8-b25d3bf0b940  
DEVICE=ens160  
ONBOOT=yes  
IPADDR=192.168.10.31  
PREFIX=24  
GATEWAY=192.168.10.1  
DNS1=192.168.10.11  
```
---

## DNS 설정 파일

### `/etc/resolv.conf`

- 기본 구조
```text
search 기본도메인명  
nameserver DNS서버IP  
```
- NetworkManager에 의해 시스템 재부팅 시  
  인터페이스 설정 파일 기준으로 자동 재구성됩니다.
- DNS 서버 테스트 시 임시 설정은 이 파일을 사용합니다.
- 해당 파일 수정 시 로컬 DNS 설정이 변경됩니다.

---

## /etc/sysconfig/network 파일
```text
NOZEROCONF=yes  
```
- Zero Configuration Networking을 위한 예약 서브넷 제거
- 반드시 필요한 옵션은 아닙니다.

---

## TCP/IP 설정 파일 전체 예시

### Rocky Linux 8
```text
/etc/sysconfig/network-scripts/ifcfg-ens160
```
```text
TYPE=Ethernet  
PROXY_METHOD=none  
BROWSER_ONLY=no  
BOOTPROTO=none  
DEFROUTE=yes  
IPV4_FAILURE_FATAL=no  
IPV6INIT=yes  
UUID=2e57c2df-b5bf-4d38-8ac4-a69f7c7112bd  
DEVICE=ens160  
ONBOOT=yes  
IPADDR=192.168.10.31  
PREFIX=24  
GATEWAY=192.168.10.1  
DNS1=192.168.10.11  
IPV6_PRIVACY=no  
```
---

### Rocky Linux 9
```text
/etc/NetworkManager/system-connections/ens160.nmconnection
```
```text
[connection]  
id=ens160  
uuid=fcaf506e-d586-3754-8ca5-6122512cfc16  
type=ethernet  
autoconnect-priority=-999  
interface-name=ens160  
timestamp=1762245080  

[ethernet]  

[ipv4]  
address1=192.168.10.32/24  
dns=192.168.10.11;  
gateway=192.168.10.1  
method=manual  

[ipv6]  
addr-gen-mode=eui64  
method=auto  
```
---

## DNS 설정 확인
```text
/etc/resolv.conf
```
